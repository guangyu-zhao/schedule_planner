<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Schedule Planner - Login</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìÖ</text></svg>">
    <link rel="stylesheet" href="/static/css/auth.css">
</head>
<body>
    <div class="auth-container">
        <div class="auth-left">
            <div class="auth-brand">
                <div class="auth-logo">üìÖ</div>
                <h1 data-i18n="auth.brand">Schedule Planner</h1>
                <p class="auth-tagline" data-i18n="auth.tagline">Manage time efficiently, stay focused on your goals</p>
            </div>
            <div class="auth-features">
                <div class="auth-feature">
                    <span class="feature-icon">üìã</span>
                    <div>
                        <strong data-i18n="auth.feature.schedule">Schedule</strong>
                        <p data-i18n="auth.feature.schedule.desc">Plan vs. actual dual-column view, making every day crystal clear</p>
                    </div>
                </div>
                <div class="auth-feature">
                    <span class="feature-icon">‚è±Ô∏è</span>
                    <div>
                        <strong data-i18n="auth.feature.timer">Focus Timer</strong>
                        <p data-i18n="auth.feature.timer.desc">Pomodoro-style focus timer, recording every deep work session</p>
                    </div>
                </div>
                <div class="auth-feature">
                    <span class="feature-icon">üìä</span>
                    <div>
                        <strong data-i18n="auth.feature.stats">Statistics</strong>
                        <p data-i18n="auth.feature.stats.desc">Multi-dimensional visual analytics, insights into time usage trends</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="auth-right">
            <div class="auth-lang-select">
                <select id="langSelect" onchange="changeAuthLanguage(this.value)">
                    <!-- options populated by JS -->
                </select>
            </div>
            <!-- Login Form -->
            <div class="auth-form-wrap active" id="loginForm">
                <h2 data-i18n="auth.login.title">Welcome Back</h2>
                <p class="auth-subtitle" data-i18n="auth.login.subtitle">Sign in to your account to continue</p>
                <form onsubmit="return handleLogin(event)">
                    <div class="auth-field">
                        <label for="loginEmail" data-i18n="auth.email">Email</label>
                        <input type="email" id="loginEmail" placeholder="your@email.com" required autocomplete="email">
                    </div>
                    <div class="auth-field">
                        <label for="loginPassword" data-i18n="auth.password">Password</label>
                        <input type="password" id="loginPassword" data-i18n-placeholder="auth.password.placeholder" placeholder="Enter password" required autocomplete="current-password">
                    </div>
                    <div class="auth-options">
                        <label class="auth-checkbox">
                            <input type="checkbox" id="loginRemember" checked>
                            <span data-i18n="auth.remember">Remember me</span>
                        </label>
                        <a href="#" class="auth-link" onclick="showForm('forgot')" data-i18n="auth.forgot">Forgot password?</a>
                    </div>
                    <div class="auth-error" id="loginError"></div>
                    <button type="submit" class="auth-btn" id="loginBtn" data-i18n="auth.login.btn">Sign In</button>
                </form>
                <div class="auth-switch">
                    <span data-i18n="auth.login.noAccount">Don't have an account?</span> <a href="#" onclick="showForm('register')"><span data-i18n="auth.login.register">Sign Up</span></a>
                </div>
            </div>

            <!-- Register Form -->
            <div class="auth-form-wrap" id="registerForm">
                <h2 data-i18n="auth.register.title">Create Account</h2>
                <p class="auth-subtitle" data-i18n="auth.register.subtitle">Register to start managing your time</p>
                <form onsubmit="return handleRegister(event)">
                    <div class="auth-field">
                        <label for="regEmail" data-i18n="auth.email">Email</label>
                        <input type="email" id="regEmail" placeholder="your@email.com" required autocomplete="email">
                    </div>
                    <div class="auth-field">
                        <label for="regUsername" data-i18n="auth.username">Username</label>
                        <input type="text" id="regUsername" data-i18n-placeholder="auth.username.placeholder" placeholder="2-30 characters" required minlength="2" maxlength="30" autocomplete="username">
                    </div>
                    <div class="auth-field">
                        <label for="regPassword" data-i18n="auth.password">Password</label>
                        <input type="password" id="regPassword" data-i18n-placeholder="auth.password.requirement" placeholder="At least 8 characters, with letters and numbers" required minlength="8" autocomplete="new-password">
                    </div>
                    <div class="auth-field">
                        <label for="regConfirm" data-i18n="auth.confirmPassword">Confirm Password</label>
                        <input type="password" id="regConfirm" data-i18n-placeholder="auth.confirmPassword.placeholder" placeholder="Enter password again" required autocomplete="new-password">
                    </div>
                    <div class="auth-error" id="registerError"></div>
                    <button type="submit" class="auth-btn" id="registerBtn" data-i18n="auth.register.btn">Sign Up</button>
                </form>
                <div class="auth-switch">
                    <span data-i18n="auth.register.hasAccount">Already have an account?</span> <a href="#" onclick="showForm('login')"><span data-i18n="auth.register.login">Sign In</span></a>
                </div>
            </div>

            <!-- Forgot Password Form -->
            <div class="auth-form-wrap" id="forgotForm">
                <h2 data-i18n="auth.reset.title">Reset Password</h2>
                <p class="auth-subtitle" id="forgotSubtitle" data-i18n="auth.reset.subtitle">Enter your registered email, we'll send a verification code</p>

                <!-- Step 1: Enter email -->
                <div id="forgotStep1">
                    <form onsubmit="return handleForgot(event)">
                        <div class="auth-field">
                            <label for="forgotEmail" data-i18n="auth.email">Email</label>
                            <input type="email" id="forgotEmail" placeholder="your@email.com" required autocomplete="email">
                        </div>
                        <div class="auth-error" id="forgotError"></div>
                        <button type="submit" class="auth-btn" id="forgotBtn" data-i18n="auth.sendCode">Send Code</button>
                    </form>
                </div>

                <!-- Step 2: Enter code -->
                <div id="forgotStep2" style="display:none">
                    <form onsubmit="return handleVerifyCode(event)">
                        <div class="auth-field">
                            <label for="verifyCode" data-i18n="auth.verifyCode">Verification Code</label>
                            <input type="text" id="verifyCode" data-i18n-placeholder="auth.verifyCode.placeholder" placeholder="Enter 6-digit code" required maxlength="6" pattern="\d{6}" autocomplete="one-time-code" inputmode="numeric">
                        </div>
                        <div class="auth-error" id="verifyError"></div>
                        <button type="submit" class="auth-btn" id="verifyBtn" data-i18n="auth.verify">Verify</button>
                    </form>
                </div>

                <!-- Step 3: New password -->
                <div id="forgotStep3" style="display:none">
                    <form onsubmit="return handleResetPassword(event)">
                        <div class="auth-field">
                            <label for="newPassword" data-i18n="auth.newPassword">New Password</label>
                            <input type="password" id="newPassword" data-i18n-placeholder="auth.password.requirement" placeholder="At least 8 characters, with letters and numbers" required minlength="8" autocomplete="new-password">
                        </div>
                        <div class="auth-field">
                            <label for="newConfirm" data-i18n="auth.confirmNewPassword">Confirm New Password</label>
                            <input type="password" id="newConfirm" data-i18n-placeholder="auth.confirmNew.placeholder" placeholder="Enter new password again" required autocomplete="new-password">
                        </div>
                        <div class="auth-error" id="resetError"></div>
                        <button type="submit" class="auth-btn" id="resetBtn" data-i18n="auth.resetPassword">Reset Password</button>
                    </form>
                </div>

                <div class="auth-switch">
                    <a href="#" onclick="showForm('login')" data-i18n="auth.backToLogin">‚Üê Back to Sign In</a>
                </div>
            </div>
        </div>
    </div>
    <script>
        (function() {
            var t = localStorage.getItem('theme');
            if (t) document.documentElement.setAttribute('data-theme', t);
            else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) document.documentElement.setAttribute('data-theme', 'dark');
        })();
    </script>
    <script src="/static/js/i18n.js"></script>
    <script>
        (function() {
            var sel = document.getElementById('langSelect');
            if (sel && window.I18n && I18n.LANGUAGES) {
                I18n.LANGUAGES.forEach(function(lang) {
                    var opt = document.createElement('option');
                    opt.value = lang.code;
                    opt.textContent = lang.name;
                    sel.appendChild(opt);
                });
                var current = I18n.getLanguage();
                sel.value = current || 'en';
                I18n.setLanguage(sel.value);
            }
            if (window.I18n) I18n.applyTranslations();
        })();
        function changeAuthLanguage(code) {
            if (window.I18n) {
                I18n.setLanguage(code);
                document.title = I18n.t('app.title.login');
            }
        }
    </script>
    <script src="/static/js/auth.js"></script>
</body>
</html>
